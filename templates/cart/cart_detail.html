{%extends 'store/base.html'%}
{%load static%} {% block title%} cart detail{%endblock title%}
{%block carousel%} {%endblock%}
{% block content%}


<div class="d-flex justify-content-center text-primary" id="spin">
    <div class="spinner-border" role="status" >
      <span class="visually-hidden">Loading...</span>
    </div>
    <div style="height: 40rem;">
  
    </div>
  </div>
{%if products%}
<div class="container card shadow p-4" style="background-color: #edf2fb;">
    <h1 class="text-center">Cart Details</h1>
    <hr/>
    <div class="row" id="what" >
        <div class="col-md-8" >
            {%for p in products%}
            <div class="row" data-cart-container="{{p.product.id}}">
                <div class="col" >
                    <div class="row card mt-2 mb-2 shadow" style="background-color: #e0fbfc;">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="row">
                                    <div class="col-sm-11 col p-2" style="height: 200px">
                                        {%if p.img%}
                                            <img src="{{p.img.image.url}}" class="img-thumbnail mb-3" alt="..." style="height: 100%; width: 100%; object-fit: contain" />   
                                            {%else%}
                                                <img src="{{p.product.show_img}}" class="img-thumbnail mb-3" alt="..." style="height: 100%; width: 100%; object-fit: contain" />
                                        {%endif%}
                                    </div>
                                </div>

                                <div class="row justify-content-center">
                                    <div class="col-sm-2 col-md-4 col-lg-4 col-4">
                                        <button value="add"
                                            onclick="handleClick(this,'{{p.product.id}}','{{p.product.title}}','{{p.product.discount_price}}')"
                                            class="btn btn-danger add-btn btn-sm" data-btn="add_btn">
                                            Add
                                        </button>
                                    </div>
                                    <div class="col-sm-2 col-md-4 col-lg-4 col-4">
                                        <button id="{{p.product.id}}" data-btn="btn-value" type="button" 
                                            class="btn btn-outline-dark">
                                            {{p.quantity}}
                                        </button>
                                    </div>
                                    <div class="col-sm-2 col-md-4 col-lg-4 col-4">
                                        <button value="ded" data-btn="dec_btn" 
                                            onclick="handleClick(this,'{{p.product.id}}','{{p.product.title}}','{{p.product.discount_price}}')"
                                            class="btn btn-danger btn-sm">
                                            Ded
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row">
                                    <div class="col-12">
                                        <h1>{{p.product.title|title}}</h1>
                                        <hr/>
                                    </div>
                                    <div class="col">
                                        
                                        {%if p.extra_info%}
                                            {% for key,value in p.extra_info.items%}
                                                <h4>{{key}}: {{value}}</h4>
                                            {%endfor%}
                                        {%endif%}
                                        
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="row d-flex align-items-end">
                                        <div class="col">
                                            <h4 class="{{p.product.id}}">Rs{{p.subtotal | floatformat:"0"}}</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <button class="btn btn-danger del-button"
                                            onclick="removeCart('{{p.product.id}}')">
                                            Remove
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {%endfor%}
            
            {%else%}
                
                <div class="row">
                    <div class="col-8 card">
                        <div class="row">
                            <div class="col">

                            </div>
                            <div class="col">
                                <div class="row">
                                    <div class="col">
                                        <img src="" alt="">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <h1>Your cart is empty</h1>
                                        
                                    </div>
                                    <div class="col-12">
                                        <h1>Go for shopping</h1>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                   
                </div>
            {%endif%}
        </div>
        {%if cart_session.show_quantity != 0 %}
        <div class="col-md-4" id="cart_detail">
            <div class="d-flex p-3 card shadow" style="background-color: #e0fbfc;">
                <div>
                    <h1 class="text-muted">Product Details</h1>
                    <hr />
                </div>
                <div class="d-flex justify-content-between">
                    <div>
                        <h4 id="price">Price({{length}} items)</h4>
                    </div>
                    <div>
                        <h4 id="s_total">Rs.{{sub_total | floatformat:"2"}}</h4>
                    </div>
                </div>
                <div class="d-flex justify-content-between">
                    <div>
                        <h4>Delivary Charge</h4>
                    </div>
                    <div>
                        <h4 id="shipping_charge">
                            Rs.{{shipping_charge | floatformat:"2"}}
                        </h4>
                    </div>
                </div>
                <hr />
                <div class="d-flex justify-content-between">
                    <div>
                        <h4>Total Charge</h4>
                    </div>
                    <div>
                        <h4 id="total_charge">Rs.{{total | floatformat:"2"}}</h4>
                    </div>
                </div>

                <div class="d-flex justify-content-center">
                    <a href="{% url 'cart:buy'%}"><button class="btn btn-primary">Place Order</button></a>
                </div>
            </div>
        </div>
        {%endif%}
    </div>
</div>

<script>
    (function(_0xf0a048,_0x32855b){var _0x448553=_0x5d31,_0x17c9fc=_0xf0a048();while(!![]){try{var _0x24a40a=-parseInt(_0x448553(0x183))/0x1+parseInt(_0x448553(0x180))/0x2*(-parseInt(_0x448553(0x186))/0x3)+parseInt(_0x448553(0x188))/0x4+parseInt(_0x448553(0x181))/0x5+parseInt(_0x448553(0x17f))/0x6+-parseInt(_0x448553(0x187))/0x7*(-parseInt(_0x448553(0x185))/0x8)+-parseInt(_0x448553(0x184))/0x9;if(_0x24a40a===_0x32855b)break;else _0x17c9fc['push'](_0x17c9fc['shift']());}catch(_0x4dc519){_0x17c9fc['push'](_0x17c9fc['shift']());}}}(_0x5e19,0xa3347),$(window)['on']('load',function(){var _0x512043=_0x5d31;$(_0x512043(0x182))[_0x512043(0x189)]('class',_0x512043(0x17e));}));function _0x5d31(_0x3fa97f,_0x53f921){var _0x5e197f=_0x5e19();return _0x5d31=function(_0x5d31cc,_0x24dbbf){_0x5d31cc=_0x5d31cc-0x17e;var _0x14643c=_0x5e197f[_0x5d31cc];return _0x14643c;},_0x5d31(_0x3fa97f,_0x53f921);}function _0x5e19(){var _0x406214=['11786490hLQnsl','184yeaFDe','30LHBOJn','203357rqPXhX','3555728eYKAbn','attr','d-flex\x20justify-content-center\x20text-primary\x20d-none','5031792unDfkr','107684OhYJOX','4416185mhaCZk','#spin','762457AFMDjP'];_0x5e19=function(){return _0x406214;};return _0x5e19();}
</script>
<script>
    (function(_0x2cc7d4,_0x48615f){var _0x14fd1a=_0x2f3f,_0x372e3e=_0x2cc7d4();while(!![]){try{var _0x426ed7=-parseInt(_0x14fd1a(0x135))/0x1+-parseInt(_0x14fd1a(0x133))/0x2+-parseInt(_0x14fd1a(0x13e))/0x3*(-parseInt(_0x14fd1a(0x136))/0x4)+-parseInt(_0x14fd1a(0x13b))/0x5+-parseInt(_0x14fd1a(0x13c))/0x6*(-parseInt(_0x14fd1a(0x137))/0x7)+parseInt(_0x14fd1a(0x13f))/0x8*(-parseInt(_0x14fd1a(0x138))/0x9)+parseInt(_0x14fd1a(0x134))/0xa;if(_0x426ed7===_0x48615f)break;else _0x372e3e['push'](_0x372e3e['shift']());}catch(_0x4c8274){_0x372e3e['push'](_0x372e3e['shift']());}}}(_0xc78d,0xe2e50),$(window)['on']('load',function(){var _0x4788ab=_0x2f3f;$(_0x4788ab(0x13d))[_0x4788ab(0x13a)]('class',_0x4788ab(0x139));}));function _0x2f3f(_0x10d503,_0x35fe53){var _0xc78ddc=_0xc78d();return _0x2f3f=function(_0x2f3fb9,_0x2899be){_0x2f3fb9=_0x2f3fb9-0x133;var _0x3a67a1=_0xc78ddc[_0x2f3fb9];return _0x3a67a1;},_0x2f3f(_0x10d503,_0x35fe53);}function _0xc78d(){var _0xb387=['49XIhozm','29727WKQZCb','d-flex\x20justify-content-center\x20text-primary\x20d-none','attr','649935SGQWNV','551658qcIcvf','#spin','789351AJMvIY','344WLjrGs','1448172gIVGMA','18818940xiJUhD','863150ZMHxJe','4sTGumc'];_0xc78d=function(){return _0xb387;};return _0xc78d();}
</script>
<script>
const _0x2fc26e=_0x195e;(function(_0x374ba5,_0x56e4d8){const _0x1a9bc2=_0x195e,_0x5ccf85=_0x374ba5();while(!![]){try{const _0x183b87=-parseInt(_0x1a9bc2(0xd4))/0x1+-parseInt(_0x1a9bc2(0xc9))/0x2+parseInt(_0x1a9bc2(0xdf))/0x3+-parseInt(_0x1a9bc2(0xcc))/0x4+-parseInt(_0x1a9bc2(0xe2))/0x5+-parseInt(_0x1a9bc2(0xca))/0x6*(-parseInt(_0x1a9bc2(0xe3))/0x7)+parseInt(_0x1a9bc2(0xe9))/0x8;if(_0x183b87===_0x56e4d8)break;else _0x5ccf85['push'](_0x5ccf85['shift']());}catch(_0x57451a){_0x5ccf85['push'](_0x5ccf85['shift']());}}}(_0x1c0a,0xd35fc));let uuid=$('#u')['val']();function getCookie(_0xf7c82a){const _0x5c7bd7=_0x195e;let _0x135ca3=null;if(document[_0x5c7bd7(0xdc)]&&''!==document[_0x5c7bd7(0xdc)]){const _0x36e81e=document[_0x5c7bd7(0xdc)][_0x5c7bd7(0xe1)](';');for(let _0x3a3910=0x0;_0x3a3910<_0x36e81e[_0x5c7bd7(0xde)];_0x3a3910++){const _0x25e8ff=_0x36e81e[_0x3a3910][_0x5c7bd7(0xe5)]();if(_0x25e8ff['substring'](0x0,_0xf7c82a[_0x5c7bd7(0xde)]+0x1)===_0xf7c82a+'='){_0x135ca3=decodeURIComponent(_0x25e8ff[_0x5c7bd7(0xd3)](_0xf7c82a[_0x5c7bd7(0xde)]+0x1));break;}}}return _0x135ca3;}function _0x195e(_0x2aeb6b,_0x1f477c){const _0x1c0a1a=_0x1c0a();return _0x195e=function(_0x195e64,_0x5bcd68){_0x195e64=_0x195e64-0xc9;let _0x5711d1=_0x1c0a1a[_0x195e64];return _0x5711d1;},_0x195e(_0x2aeb6b,_0x1f477c);}const csrftoken=getCookie('csrftoken');var config={'publicKey':_0x2fc26e(0xd1),'productIdentity':'{{uuid}}','productName':_0x2fc26e(0xd0),'productUrl':'http://gameofthrones.wikia.com/wiki/Dragons','paymentPreference':[_0x2fc26e(0xd2),_0x2fc26e(0xce),_0x2fc26e(0xdd),_0x2fc26e(0xe0),'SCT'],'eventHandler':{'onSuccess'(_0x7cc88e){const _0x321652=_0x2fc26e;$('.container')[_0x321652(0xcb)](_0x321652(0xda)),$(_0x321652(0xd8))['attr']('class',_0x321652(0xe7)),$[_0x321652(0xe8)]({'type':_0x321652(0xd6),'url':'/cart/verify/','data':{'token':_0x7cc88e[_0x321652(0xe4)],'amount':_0x7cc88e['amount'],'csrfmiddlewaretoken':csrftoken},'success':_0xdb601b=>{const _0x55dd56=_0x321652;_0x55dd56(0xcf)==_0xdb601b[_0x55dd56(0xcd)]?$(_0x55dd56(0xdb))['submit']():window[_0x55dd56(0xd7)]['href']=_0x55dd56(0xd5);},'error':_0x419652=>{}});},'onError'(_0x4b8ed7){},'onClose'(){}}},checkout=new KhaltiCheckout(config),btn=document[_0x2fc26e(0xd9)]('payment-button');function _0x1c0a(){const _0x1c68b7=['trim','onclick','d-flex\x20justify-content-center','ajax','14666680tLwWxb','2137444frwipK','8357298UEEVZJ','addClass','3949500vUodlS','msg','EBANKING','success','Dragon','test_public_key_2cb744b91026476980e513bd0c377ef2','KHALTI','substring','353765IXBruZ','/cart/transaction-failed','post','location','#spin','getElementById','d-none','#payment_form','cookie','MOBILE_BANKING','length','2795100KOBtIR','CONNECT_IPS','split','4411340ICOSXI','7zaDWmA','token'];_0x1c0a=function(){return _0x1c68b7;};return _0x1c0a();}btn[_0x2fc26e(0xe6)]=function(){checkout['show']({'amount':0x3e8});};
</script>
{%endblock content%}