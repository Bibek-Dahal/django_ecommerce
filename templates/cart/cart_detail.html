{%extends 'store/base.html'%}
{%load static%} {% block title%} cart detail{%endblock title%}
{%block carousel%} {%endblock%}
{% block content%}


<div class="d-flex justify-content-center text-primary" id="spin">
    <div class="spinner-border" role="status" >
      <span class="visually-hidden">Loading...</span>
    </div>
    <div style="height: 40rem;">
  
    </div>
  </div>
{%if products%}
<div class="container card shadow p-4" style="background-color: #edf2fb;">
    <h1 class="text-center">Cart Details</h1>
    <hr/>
    <div class="row" id="what" >
        <div class="col-md-8" >
            {%for p in products%}
            <div class="row" data-cart-container="{{p.product.id}}">
                <div class="col" >
                    <div class="row card mt-2 mb-2 shadow" style="background-color: #e0fbfc;">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="row">
                                    <div class="col-sm-11 col p-2" style="height: 200px">
                                        {%if p.img%}
                                            <img src="{{p.img.image.url}}" class="img-thumbnail mb-3" alt="..." style="height: 100%; width: 100%; object-fit: contain" />   
                                            {%else%}
                                                <img src="{{p.product.show_img}}" class="img-thumbnail mb-3" alt="..." style="height: 100%; width: 100%; object-fit: contain" />
                                        {%endif%}
                                    </div>
                                </div>

                                <div class="row justify-content-center">
                                    <div class="col-sm-2 col-md-4 col-lg-4 col-4">
                                        <button value="add"
                                            onclick="handleClick(this,'{{p.product.id}}','{{p.product.title}}','{{p.product.discount_price}}')"
                                            class="btn btn-danger add-btn btn-sm" data-btn="add_btn">
                                            Add
                                        </button>
                                    </div>
                                    <div class="col-sm-2 col-md-4 col-lg-4 col-4">
                                        <button id="{{p.product.id}}" data-btn="btn-value" type="button" 
                                            class="btn btn-outline-dark">
                                            {{p.quantity}}
                                        </button>
                                    </div>
                                    <div class="col-sm-2 col-md-4 col-lg-4 col-4">
                                        <button value="ded" data-btn="dec_btn" 
                                            onclick="handleClick(this,'{{p.product.id}}','{{p.product.title}}','{{p.product.discount_price}}')"
                                            class="btn btn-danger btn-sm">
                                            Ded
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row">
                                    <div class="col-12">
                                        <h1>{{p.product.title|title}}</h1>
                                        <hr/>
                                    </div>
                                    <div class="col">
                                        
                                        {%if p.extra_info%}
                                            {% for key,value in p.extra_info.items%}
                                                <h4>{{key}}: {{value}}</h4>
                                            {%endfor%}
                                        {%endif%}
                                        
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="row d-flex align-items-end">
                                        <div class="col">
                                            <h4 class="{{p.product.id}}">Rs{{p.subtotal | floatformat:"0"}}</h4>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <button class="btn btn-danger del-button"
                                            onclick="removeCart('{{p.product.id}}')">
                                            Remove
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {%endfor%}
            
            {%else%}
                
                <div class="row">
                    <div class="col-8 card">
                        <div class="row">
                            <div class="col">

                            </div>
                            <div class="col">
                                <div class="row">
                                    <div class="col">
                                        <img src="" alt="">
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <h1>Your cart is empty</h1>
                                        
                                    </div>
                                    <div class="col-12">
                                        <h1>Go for shopping</h1>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                   
                </div>
            {%endif%}
        </div>
        {%if cart_session.show_quantity != 0 %}
        <div class="col-md-4" id="cart_detail">
            <div class="d-flex p-3 card shadow" style="background-color: #e0fbfc;">
                <div>
                    <h1 class="text-muted">Product Details</h1>
                    <hr />
                </div>
                <div class="d-flex justify-content-between">
                    <div>
                        <h4 id="price">Price({{length}} items)</h4>
                    </div>
                    <div>
                        <h4 id="s_total">Rs.{{sub_total | floatformat:"2"}}</h4>
                    </div>
                </div>
                <div class="d-flex justify-content-between">
                    <div>
                        <h4>Delivary Charge</h4>
                    </div>
                    <div>
                        <h4 id="shipping_charge">
                            Rs.{{shipping_charge | floatformat:"2"}}
                        </h4>
                    </div>
                </div>
                <hr />
                <div class="d-flex justify-content-between">
                    <div>
                        <h4>Total Charge</h4>
                    </div>
                    <div>
                        <h4 id="total_charge">Rs.{{total | floatformat:"2"}}</h4>
                    </div>
                </div>

                <div class="d-flex justify-content-center">
                    <a href="{% url 'cart:buy'%}"><button class="btn btn-primary">Place Order</button></a>
                </div>
            </div>
        </div>
        {%endif%}
    </div>
</div>

<script>
    $("#spin").attr('class','d-flex justify-content-center text-primary');
</script>
<script>
    $(window).on("load", function () {
     
        $("#spin").attr('class','d-flex justify-content-center text-primary d-none');
    });
</script>
<script>
    var _0x7db99a=_0x64c9;function _0x64c9(_0xc9b820,_0x29b7da){var _0x57a2e9=_0x57a2();return _0x64c9=function(_0x64c9d6,_0x2581c2){_0x64c9d6=_0x64c9d6-0x70;var _0x36fc76=_0x57a2e9[_0x64c9d6];return _0x36fc76;},_0x64c9(_0xc9b820,_0x29b7da);}(function(_0x1df6ea,_0xeb958f){var _0x3769ec=_0x64c9,_0x3c5739=_0x1df6ea();while(!![]){try{var _0x297c63=parseInt(_0x3769ec(0x75))/0x1*(-parseInt(_0x3769ec(0x73))/0x2)+-parseInt(_0x3769ec(0x7f))/0x3*(parseInt(_0x3769ec(0x79))/0x4)+parseInt(_0x3769ec(0x74))/0x5*(-parseInt(_0x3769ec(0x7a))/0x6)+-parseInt(_0x3769ec(0x71))/0x7*(-parseInt(_0x3769ec(0x80))/0x8)+parseInt(_0x3769ec(0x72))/0x9*(parseInt(_0x3769ec(0x70))/0xa)+-parseInt(_0x3769ec(0x7e))/0xb+-parseInt(_0x3769ec(0x7b))/0xc*(-parseInt(_0x3769ec(0x7d))/0xd);if(_0x297c63===_0xeb958f)break;else _0x3c5739['push'](_0x3c5739['shift']());}catch(_0x760e1c){_0x3c5739['push'](_0x3c5739['shift']());}}}(_0x57a2,0xda32e),$(window)['on'](_0x7db99a(0x7c),function(){var _0x2148a6=_0x7db99a;$('#spin')[_0x2148a6(0x78)](_0x2148a6(0x76),_0x2148a6(0x77));}));function _0x57a2(){var _0xbe1bd=['81aYxMnH','1028zkBEJY','65ndaxRA','2985VSBrYV','class','d-flex\x20justify-content-center\x20text-primary\x20d-none','attr','4XNLKSA','607842TicTKn','12PXPgoY','load','32192381gBkzbS','11485342FYoWzI','1480569gDXaYk','6031136YdfPKX','1442830SBMmkV','14jmiznd'];_0x57a2=function(){return _0xbe1bd;};return _0x57a2();}
</script>
{%endblock content%}